<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dynabench.dataset &mdash; dynabench 0.4.3 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
      <link rel="stylesheet" type="text/css" href="../_static/dynabench.css?v=cb3fec7a" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5bfaad31"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/design-tabs.js?v=36754332"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="dynabench.dataset.transforms" href="dynabench.dataset.transforms.html" />
    <link rel="prev" title="API reference" href="../api.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            dynabench
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../papers.html">Papers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../results.html">Benchmark Results</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">dynabench.dataset</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dynabench.dataset.BaseListMovingWindowIterator"><code class="docutils literal notranslate"><span class="pre">BaseListMovingWindowIterator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynabench.dataset.BaseListSimulationIterator"><code class="docutils literal notranslate"><span class="pre">BaseListSimulationIterator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynabench.dataset.DynabenchIterator"><code class="docutils literal notranslate"><span class="pre">DynabenchIterator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynabench.dataset.DynabenchSimulationIterator"><code class="docutils literal notranslate"><span class="pre">DynabenchSimulationIterator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynabench.dataset.EquationMovingWindowIterator"><code class="docutils literal notranslate"><span class="pre">EquationMovingWindowIterator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynabench.dataset.EquationSimulationIterator"><code class="docutils literal notranslate"><span class="pre">EquationSimulationIterator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynabench.dataset.download_equation"><code class="docutils literal notranslate"><span class="pre">download_equation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="dynabench.dataset.transforms.html">dynabench.dataset.transforms</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dynabench.equation.html">dynabench.equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynabench.model.html">dynabench.model</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynabench.solver.html">dynabench.solver</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynabench.initial.html">dynabench.initial</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynabench.grid.html">dynabench.grid</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">dynabench</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">API reference</a></li>
      <li class="breadcrumb-item active">dynabench.dataset</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/reference/dynabench.dataset.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-dynabench.dataset">
<span id="dynabench-dataset"></span><h1>dynabench.dataset<a class="headerlink" href="#module-dynabench.dataset" title="Link to this heading"></a></h1>
<p>Module for loading the data.</p>
<p class="rubric">Functions</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dynabench.dataset.download_equation" title="dynabench.dataset.download_equation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">download_equation</span></code></a>(equation, structure, ...)</p></td>
<td><p>Download a dataset and unpack it to the right place.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Classes</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#dynabench.dataset.BaseListMovingWindowIterator" title="dynabench.dataset.BaseListMovingWindowIterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseListMovingWindowIterator</span></code></a>(data_paths, ...)</p></td>
<td><p>Iterator for arbitrary equations generated using the dynabench solver.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dynabench.dataset.BaseListSimulationIterator" title="dynabench.dataset.BaseListSimulationIterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseListSimulationIterator</span></code></a>(data_paths, ...)</p></td>
<td><p>Iterates over full simulations.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dynabench.dataset.DynabenchIterator" title="dynabench.dataset.DynabenchIterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DynabenchIterator</span></code></a>(split, equation, ...)</p></td>
<td><p>Iterator for the Dynabench dataset.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dynabench.dataset.DynabenchSimulationIterator" title="dynabench.dataset.DynabenchSimulationIterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DynabenchSimulationIterator</span></code></a>(split, equation, ...)</p></td>
<td><p>Iterator for the Dynabench dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#dynabench.dataset.EquationMovingWindowIterator" title="dynabench.dataset.EquationMovingWindowIterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EquationMovingWindowIterator</span></code></a>(eq_dir, ...)</p></td>
<td><p>Iterator for arbitrary equations generated using the dynabench solver.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#dynabench.dataset.EquationSimulationIterator" title="dynabench.dataset.EquationSimulationIterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EquationSimulationIterator</span></code></a>(eq_dir, ...)</p></td>
<td><p>Iterator for full equations generated using the dynabench solver.</p></td>
</tr>
</tbody>
</table>
<dl class="py class">
<dt class="sig sig-object py" id="dynabench.dataset.BaseListMovingWindowIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dynabench.dataset.</span></span><span class="sig-name descname"><span class="pre">BaseListMovingWindowIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">data_paths:</span> <span class="pre">~typing.List[str],</span> <span class="pre">lookback:</span> <span class="pre">int,</span> <span class="pre">rollout:</span> <span class="pre">int,</span> <span class="pre">squeeze_lookback_dim:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True,</span> <span class="pre">is_batched:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">transforms:</span> <span class="pre">~dynabench.dataset.transforms.BaseTransform</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">dtype:</span> <span class="pre">~numpy.dtype</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dynabench/dataset/_base.html#BaseListMovingWindowIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynabench.dataset.BaseListMovingWindowIterator" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Iterator for arbitrary equations generated using the dynabench solver. Each sample returned by the __getitem__ method is a tuple of
(data_input, data_target, points), where data_input is the input data of shape (L, F, H, W), data_target is the target data of shape (R, F, H, W), and points are the points in the grid of shape (H, W, 2).
In this context L corresponds to the lookback parameter and R corresponds to the rollout parameter. H and W are the height and width of the grid, respectively. F is the number of variables in the equation system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_paths</strong> (<em>str</em>) – List of paths to the files containing the simulation data.</p></li>
<li><p><strong>lookback</strong> (<em>int</em>) – Number of time steps to look back. This corresponds to the L parameter.</p></li>
<li><p><strong>rollout</strong> (<em>int</em>) – Number of time steps to predict. This corresponds to the R parameter.</p></li>
<li><p><strong>squeeze_lookback_dim</strong> (<em>bool</em>) – Whether to squeeze the lookback dimension. Defaults to False. If lookback &gt; 1 has no effect.</p></li>
<li><p><strong>is_batched</strong> (<em>bool</em>) – Whether the data is batched. Defaults to False. If True, the data is expected to be of shape (B, L, F, H, W), where B is the batch size.</p></li>
<li><p><strong>dtype</strong> (<em>np.dtype</em>) – Data type of the input data. Defaults to np.float32.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynabench.dataset.BaseListSimulationIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dynabench.dataset.</span></span><span class="sig-name descname"><span class="pre">BaseListSimulationIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">data_paths:</span> <span class="pre">~typing.List[str],</span> <span class="pre">is_batched:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False,</span> <span class="pre">transforms:</span> <span class="pre">~dynabench.dataset.transforms.BaseTransform</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None,</span> <span class="pre">dtype:</span> <span class="pre">~numpy.dtype</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dynabench/dataset/_base.html#BaseListSimulationIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynabench.dataset.BaseListSimulationIterator" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Iterates over full simulations. Each sample returned by the __getitem__ method is a tuple of
(data, points), where data is the simulation data of shape (T, F, H, W) and points are the points in the grid of shape (H, W, 2).
In this context T corresponds to the number of time steps, H and W are the height and width of the grid, respectively. F is the number of variables in the equation system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_paths</strong> (<em>str</em>) – List of paths to the files containing the simulation data.</p></li>
<li><p><strong>lookback</strong> (<em>int</em>) – Number of time steps to look back. This corresponds to the L parameter.</p></li>
<li><p><strong>rollout</strong> (<em>int</em>) – Number of time steps to predict. This corresponds to the R parameter.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynabench.dataset.DynabenchIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dynabench.dataset.</span></span><span class="sig-name descname"><span class="pre">DynabenchIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equation:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'wave'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'cloud'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'low'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_path:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lookback:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squeeze_lookback_dim:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rollout:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transforms:</span> <span class="pre">~dynabench.dataset.transforms.BaseTransform</span> <span class="pre">=</span> <span class="pre">DefaultTransform{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype:</span> <span class="pre">~numpy.dtype</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">download:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dynabench/dataset/_dynabench.html#DynabenchIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynabench.dataset.DynabenchIterator" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynabench.dataset.BaseListMovingWindowIterator" title="dynabench.dataset._base.BaseListMovingWindowIterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseListMovingWindowIterator</span></code></a></p>
<p>Iterator for the Dynabench dataset. This iterator will iterate over each simulation in the dataset,
by moving a window over the simulation data.
The window size is defined by the lookback and rollout parameters, which define the number of timesteps
to be used as input and output, respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split</strong> (<em>str</em>) – The split of the dataset to use. Can be “train”, “val” or “test”.</p></li>
<li><p><strong>equation</strong> (<em>str</em>) – The equation to use. Can be “advection”, “burgers”, “gasdynamics”, “kuramotosivashinsky”, “reactiondiffustion” or “wave”.</p></li>
<li><p><strong>structure</strong> (<em>str</em>) – The structure of the dataset. Can be “cloud” or “grid”.</p></li>
<li><p><strong>resolution</strong> (<em>str</em>) – The resolution of the dataset. Can be <em>low</em>, <em>medium</em>, <em>high</em> or <em>full</em>.
Low resolution corresponds to 225 points in total (aranged in a 15x15 grid for the grid structure).
Medium resolution corresponds to 484 points in total (aranged in a 22x22 grid for the grid structure).
High resolution corresponds to 900 points in total (aranged in a 30x30 grid for the grid structure).
Full resolution uses the full simulation grid of shape (64x64) that has been used to numerically solve the simulations.</p></li>
<li><p><strong>base_path</strong> (<em>str</em>) – Location where the data is stored. Defaults to “data”.</p></li>
<li><p><strong>lookback</strong> (<em>int</em>) – Number of timesteps to use for the input data. Defaults to 1.</p></li>
<li><p><strong>squeeze_lookback_dim</strong> (<em>bool</em>) – Whether to squeeze the lookback dimension. Defaults to False. If lookback &gt; 1 has no effect.</p></li>
<li><p><strong>rollout</strong> (<em>int</em>) – Number of timesteps to use for the target data. Defaults to 1.</p></li>
<li><p><strong>download</strong> (<em>int</em>) – Whether to download the data. Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynabench.dataset.DynabenchSimulationIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dynabench.dataset.</span></span><span class="sig-name descname"><span class="pre">DynabenchSimulationIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equation:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'wave'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'cloud'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'low'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transforms:</span> <span class="pre">~dynabench.dataset.transforms.BaseTransform</span> <span class="pre">=</span> <span class="pre">DefaultTransform{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_path:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">download:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype:</span> <span class="pre">~numpy.dtype</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dynabench/dataset/_dynabench.html#DynabenchSimulationIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynabench.dataset.DynabenchSimulationIterator" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Iterator for the Dynabench dataset. This iterator will iterate all the simulations in the dataset, returning the full simulation as a single sample.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split</strong> (<em>str</em>) – The split of the dataset to use. Can be “train”, “val” or “test”.</p></li>
<li><p><strong>equation</strong> (<em>str</em>) – The equation to use. Can be “advection”, “burgers”, “gasdynamics”, “kuramotosivashinsky”, “reactiondiffustion” or “wave”.</p></li>
<li><p><strong>structure</strong> (<em>str</em>) – The structure of the dataset. Can be “cloud” or “grid”.</p></li>
<li><p><strong>resolution</strong> (<em>str</em>) – The resolution of the dataset. Can be <em>low</em>, <em>medium</em>, <em>high</em> or <em>full</em>.
Low resolution corresponds to 225 points in total (aranged in a 15x15 grid for the grid structure).
Medium resolution corresponds to 484 points in total (aranged in a 22x22 grid for the grid structure).
High resolution corresponds to 900 points in total (aranged in a 30x30 grid for the grid structure).
Full resolution uses the full simulation grid of shape (64x64) that has been used to numerically solve the simulations.</p></li>
<li><p><strong>base_path</strong> (<em>str</em>) – Location where the data is stored. Defaults to “data”.</p></li>
<li><p><strong>download</strong> (<em>int</em>) – Whether to download the data. Defaults to False.</p></li>
<li><p><strong>dtype</strong> (<em>np.dtype</em>) – Data type of the input data. Defaults to np.float32.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynabench.dataset.EquationMovingWindowIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dynabench.dataset.</span></span><span class="sig-name descname"><span class="pre">EquationMovingWindowIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eq_dir:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lookback:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rollout:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_simulations:</span> <span class="pre">~typing.List[str]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">squeeze_lookback_dim:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_batched:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transforms:</span> <span class="pre">~dynabench.dataset.transforms.BaseTransform</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype:</span> <span class="pre">~numpy.dtype</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dynabench/dataset/_equation.html#EquationMovingWindowIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynabench.dataset.EquationMovingWindowIterator" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynabench.dataset.BaseListMovingWindowIterator" title="dynabench.dataset._base.BaseListMovingWindowIterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseListMovingWindowIterator</span></code></a></p>
<p>Iterator for arbitrary equations generated using the dynabench solver. Each sample returned by the __getitem__ method is a tuple of
(data_input, data_target, points), where data_input is the input data of shape (L, F, H, W), data_target is the target data of shape (R, F, H, W), and points are the points in the grid of shape (H, W, 2).
In this context L corresponds to the lookback parameter and R corresponds to the rollout parameter. H and W are the height and width of the grid, respectively. F is the number of variables in the equation system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eq_dir</strong> (<em>str</em>) – Path to the directory where the generated simulations are stored.</p></li>
<li><p><strong>lookback</strong> (<em>int</em>) – Number of time steps to look back. This corresponds to the L parameter.</p></li>
<li><p><strong>rollout</strong> (<em>int</em>) – Number of time steps to predict. This corresponds to the R parameter.</p></li>
<li><p><strong>squeeze_lookback_dim</strong> (<em>bool</em>) – Whether to squeeze the lookback dimension. Defaults to False. If lookback &gt; 1 has no effect.</p></li>
<li><p><strong>is_batched</strong> (<em>bool</em>) – Whether the data is batched. Defaults to False. If True, the data is expected to be of shape (B, L, F, H, W), where B is the batch size.</p></li>
<li><p><strong>dtype</strong> (<em>np.dtype</em>) – Data type of the input data. Defaults to np.float32.</p></li>
<li><p><strong>selected_simulations</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – List of selected simulation names to load. If None, all simulations in the directory are loaded.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dynabench.dataset.EquationSimulationIterator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dynabench.dataset.</span></span><span class="sig-name descname"><span class="pre">EquationSimulationIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eq_dir:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_simulations:</span> <span class="pre">~typing.List[str]</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_batched:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transforms:</span> <span class="pre">~dynabench.dataset.transforms.BaseTransform</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype:</span> <span class="pre">~numpy.dtype</span> <span class="pre">=</span> <span class="pre">&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dynabench/dataset/_equation.html#EquationSimulationIterator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynabench.dataset.EquationSimulationIterator" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynabench.dataset.BaseListSimulationIterator" title="dynabench.dataset._base.BaseListSimulationIterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseListSimulationIterator</span></code></a></p>
<p>Iterator for full equations generated using the dynabench solver. Each sample returned by the __getitem__ method is a tuple of
(data_input, points), where data_input is the input data of shape (L, F, H, W), data_target is the target data of shape (R, F, H, W), and points are the points in the grid of shape (H, W, 2).
In this context L corresponds to the lookback parameter and R corresponds to the rollout parameter. H and W are the height and width of the grid, respectively. F is the number of variables in the equation system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eq_dir</strong> (<em>str</em>) – Path to the directory where the generated simulations are stored.</p></li>
<li><p><strong>is_batched</strong> (<em>bool</em>) – Whether the data is batched. Defaults to False. If True, the data is expected to be of shape (B, L, F, H, W), where B is the batch size.</p></li>
<li><p><strong>dtype</strong> (<em>np.dtype</em>) – Data type of the input data. Defaults to np.float32.</p></li>
<li><p><strong>selected_simulations</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – List of selected simulation names to load. If None, all simulations in the directory are loaded.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dynabench.dataset.download_equation">
<span class="sig-prename descclassname"><span class="pre">dynabench.dataset.</span></span><span class="sig-name descname"><span class="pre">download_equation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'tmp'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/dynabench/dataset/_download.html#download_equation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynabench.dataset.download_equation" title="Link to this definition"></a></dt>
<dd><p>Download a dataset and unpack it to the right place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equation</strong> (<em>str</em>) – Name of the equation to download.</p></li>
<li><p><strong>structure</strong> (<em>str</em>) – Description of how the observation points are structured. Can be “cloud” or “grid”.</p></li>
<li><p><strong>resolution</strong> (<em>str</em>) – Resolution of the dataset. Can be “low”, “medium”, or “high”.</p></li>
<li><p><strong>data_dir</strong> (<em>str</em>) – Directory where the dataset should be saved. Defaults to “data/”.</p></li>
<li><p><strong>tmp_dir</strong> (<em>str</em>) – Directory where the temporary files should be saved. Defaults to “data/tmp/”. This directory will be deleted after the dataset is unpacked.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Modules</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="dynabench.dataset.transforms.html#module-dynabench.dataset.transforms" title="dynabench.dataset.transforms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transforms</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../api.html" class="btn btn-neutral float-left" title="API reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dynabench.dataset.transforms.html" class="btn btn-neutral float-right" title="dynabench.dataset.transforms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Andrzej Dulny.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>